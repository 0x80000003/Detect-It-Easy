function getVersion(){var e=PE.nLastSection,t=PE.section[e].FileOffset,r=PE.section[e].FileSize
0==r&&(t=PE.section[e-1].FileOffset,r=PE.section[e-1].FileSize)
var i=PE.findSignature(t,r,"000000'ENIGMA'")
if(-1!=i){var n=PE.readByte(i+9),o=PE.readByte(i+10),$=PE.readWord(i+11),E=PE.readWord(i+13),P=PE.readWord(i+15),d=PE.readWord(i+17),s=PE.readWord(i+19),a=PE.readWord(i+21)
return sVersion=n+"."+o+" build "+$+"."+E+"."+P+" "+d+":"+s+":"+a,1}return-1!=(i=PE.findSignature(t,r,"'Enigma Protector'"))?(sVersion="5.X",1):0}function getVersion_old1x(){var e=PE.nLastSection
return-1!=PE.findSignature(PE.section[e].FileOffset,PE.section[e].FileSize,"'ENIGMA'07' PROT'")?(sVersion="1.14",1):0}function getVersion_old(){if(PE.section[".data"]){var e=PE.section[".data"].FileOffset
if(-1!=(e=PE.findString(e,PE.section[".data"].FileSize,"Enigma protector v")))return sVersion=PE.getString(e+18,4),1}return 0}function detect(){return PE.isPEPlus()?PE.compareEP("5051525355565741504151415241534154415541564157489C4881EC080000000FAE1C24E8000000005D")&&(getVersion(),bDetected=!0):PE.compareEP("558bec83c4..b8........e8........9a............e9$$$$$$$$60e8000000005d..ed")||PE.compareEP("60e8000000005d81ed........81ed........e9")||PE.compareEP("68........e8$$$$$$$$eb$$83c4..e9$$$$$$$$60e8000000005d81ed")||PE.compareEP("eb$$e9$$$$$$$$60e8000000005d81ed........81ed........e9")||PE.compareEP("e8$$$$$$$$83c4..e9$$$$$$$$60e8000000005d81ed........81ed........e9")?(getVersion(),bDetected=!0):PE.compareEP("60e8000000005d83....81ed")?(getVersion_old(),bDetected=!0):PE.compareEP("eb$$e9$$$$$$$$60e8000000005d83....81ed")&&(getVersion_old1x(),getVersion_old(),bDetected=!0),bDetected||(PE.getNumberOfImports()>1&&1==PE.getNumberOfImportThunks(1)&&"MessageBoxA"==PE.getImportFunctionName(1,0)&&3758096448==PE.getSectionCharacteristics(0)&&getVersion()||"enigma"==PE.getSectionNameCollision("1","2")||PE.isNET()&&PE.isSignatureInSectionPresent(0,"000000'ENIGMA'"))&&(bDetected=!0),result()}init("protector","Enigma")
