function getVersionAndOptions(e){var t=PE.getString(e)
sVersion=t.substring(0,t.indexOf(")")),/\(u\)/.test(t)?sOptions=sOptions.append("unicode"):/\(a\)/.test(t)&&(sOptions=sOptions.append("ANSI"))}function getVersion(e){if(PE.section[e]){var t=PE.section[e].FileOffset,n=PE.section[e].FileSize
if(n<16384){var i=PE.findString(t,n,"Inno Setup Setup Data")
if(-1!=i)return getVersionAndOptions(i+23),1
if(-1!=(i=PE.findSignature(t,n,"'i1.'............'32'1A")))return sVersion=PE.getString(i+1).replace(/-.*/,""),1}}return 0}function detect(){if(PE.compareOverlay("'zlb'1A")||PE.compareOverlay("'idska32'1A"))getVersion("DATA")||getVersion(".data"),bDetected=!0
else if("InUn"==PE.getString(48,4)){sOptions="uninstall"
var e=PE.findString(PE.getOverlayOffset(),Math.min(256,PE.getOverlaySize()),"Inno Setup Messages");-1!=e&&(getVersionAndOptions(e+21),bDetected=!0),bDetected||-1!=(e=PE.findString(PE.section[0].FileOffset,PE.section[0].FileSize,"Inno Setup version"))&&(getVersionAndOptions(e+19),bDetected=!0),bDetected||(getVersion("DATA")||getVersion(".data"))&&(bDetected=!0)}(bDetected||(PE.compareOverlay("'Inno Setup Messages'")?(sOptions="uninstall",getVersionAndOptions(PE.getOverlayOffset()+21),bDetected=!0):PE.compareOverlay("'Inno Setup Setup Data'")&&(getVersionAndOptions(PE.getOverlayOffset()+23),bDetected=!0)),PE.compareOverlay("78da")?(sOptions="zlib",(PE.compareEP("558bec83c4..53565733c08945..8945")||PE.compareEP("558bec83c4..e8........e8........e8"))&&(bDetected=!0)):PE.compareOverlay("'Inno'",52)&&(sOptions="with stub",bDetected=!0),bDetected)||PE.isNET()&&"This installation was built with Inno Setup."==PE.getVersionStringInfo("Comments")&&(bDetected=!0)
return result()}init("installer","Inno Setup Module")
