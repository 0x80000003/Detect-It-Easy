function detect(){for(var e="",t=0,r=0,s=0,f=0,i=0,n=0,B=0,o=PE.OffsetToVA(PE.getEntryPointOffset()),P=0;P<1e3;)P++,"CLC"==(e=-1!=(e=PE.getDisasmString(o)).indexOf(" ")?e.slice(0,e.indexOf(" ")):e)&&t++,"STC"==e&&r++,"MOVZX"==e&&s++,"SUB"==e&&f++,"IMUL"==e&&i++,"BT"!=e&&"BTR"!=e&&"BTS"!=e&&"BTC"!=e||n++,"BSF"!=e&&"BSR"!=e&&"BSWAP"!=e||B++,o=PE.getDisasmNextAddress(o)
return 0<t&&0<r&&0!=s&&(i<f||0==f&&0==i)&&0==n&&0==B&&(bDetected=!0),result()}meta("protector","PELock")
