function detect(){for(var t="",e=0,r=0,s=0,i=0,n=0,f=0,B=0,S=PE.OffsetToVA(PE.getEntryPointOffset()),o=0;o<1e3;){o++,-1!=(t=PE.getDisasmString(S)).indexOf(" ")&&(t=t.substr(0,t.indexOf(" "))),"CLC"==t&&e++,"STC"==t&&r++,"MOVSX"==t&&0,"MOVZX"==t&&s++,"SUB"==t&&i++,"IMUL"==t&&n++,"BT"!=t&&"BTR"!=t&&"BTS"!=t&&"BTC"!=t||f++,"BSF"!=t&&"BSR"!=t&&"BSWAP"!=t||B++,S=PE.getDisasmNextAddress(S)}return e>0&&r>0&&0!=s&&(i>n||0==i&&0==n)&&0==f&&0==B&&(bDetected=!0),result()}init("protector","PELock")
