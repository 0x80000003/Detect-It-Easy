function detect(){for(var t="",e=0,r=0,s=0,i=0,n=0,f=0,B=0,o=PE.OffsetToVA(PE.getEntryPointOffset()),P=0;P<1e3;)P++,"CLC"==(t=-1!=(t=PE.getDisasmString(o)).indexOf(" ")?t.substr(0,t.indexOf(" ")):t)&&e++,"STC"==t&&r++,"MOVZX"==t&&s++,"SUB"==t&&i++,"IMUL"==t&&n++,"BT"!=t&&"BTR"!=t&&"BTS"!=t&&"BTC"!=t||f++,"BSF"!=t&&"BSR"!=t&&"BSWAP"!=t||B++,o=PE.getDisasmNextAddress(o)
return 0<e&&0<r&&0!=s&&(n<i||0==i&&0==n)&&0==f&&0==B&&(bDetected=!0),result()}init("protector","PELock")
