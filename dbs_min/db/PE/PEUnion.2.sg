function detect(){if(!PE.isNET()){bDetected=!0,PE.isPEPlus()&&(bDetected=!1)
const e="kernel32.dll"
validateNativeImports(isPositive=!0,references=[[e,"GetProcAddress"],[e,"ExitProcess"],[e,"GetModuleFileNameA"],[e,"GetComputerNameA"],[e,"VirtualAllocExNuma"],["shlwapi.dll","PathFindFileNameA"]])&&(bDetected=!1)
const t="E8??????006A00FF15A4????00C3"
3==PE.getNumberOfSections()&&PE.compareEP(t)&&PE.isSectionNamePresent(".rsrc")&&PE.isSectionNamePresent(".idata")&&PE.isSectionNamePresent(".text")&&-1!=PE.findString(PE.section[".rsrc"].FileOffset,PE.section[".rsrc"].FileSize,"</assembly>")&&PE.getSectionVirtualSize(1)+PE.getSectionVirtualSize(2)<PE.getSectionVirtualSize(0)&&PE.isSignatureInSectionPresent(1,"00'Shlwapi.dll'00")||(bDetected=!1),sOptions+="RunPE"}PE.isNET()&&(bDetected=!0,validateReferences(isPositive=!0,references=["kernel32.dll","LoadLibraryA","GetProcAddress","System.Runtime.InteropServices","System.Runtime.CompilerServices","System.IO","System.Reflection","System.Resources","System.Collections.Generic","System.Core","System.Linq","IEnumerable`1","<>c__DisplayClass1","Func`2"],section=0)&&(bDetected=!1),(PE.isNetObjectPresent("BeginInvoke")||PE.isNetObjectPresent("EndInvoke"))&&(sOptions+="Invoke")),sVersion="v4.0"}function validateReferences(e,t,i){for(var n=0;n<t.length;n++){var r="00'"+t[n]+"'00"
if(1==e){if(!PE.isSignatureInSectionPresent(i,r))return!0}else if(PE.isSignatureInSectionPresent(i,r))return!0}return!1}function validateNativeImports(e,t){for(var i=0;i<t.length;i++){var n=t[i],r=n[0],s=n[1]
if(1==e){if(!PE.isLibraryFunctionPresent(r,s))return!0}else if(PE.isLibraryFunctionPresent(r,s))return!0}return!1}init("cryptor","PEUnion")
